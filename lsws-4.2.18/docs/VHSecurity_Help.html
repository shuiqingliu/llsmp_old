<!DOCTYPE html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>LiteSpeed Web Server Users' Manual - Virtual Host Security</title>
  <meta name="description" content="LiteSpeed Web Server Users' Manual - Virtual Host Security." />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="img/favicon.ico" />
  <link rel="stylesheet" type="text/css" href="css/hdoc.css">
</head>
<body>
<div class="pagewrapper"><div class="sidetree">
<h3>LiteSpeed Web Server <a href="index.html"> Users' Manual</a></h3>
<h5>Version 5.0 Rev. 1 </h5>
<hr/>
<div>
<ul class="toctop">
<li>License <a href="license_std.html">Std</a> / <a href="license.html">Ent</a></li>
<li><a href="intro.html">Introduction</a></li>
<li><a href="install.html">Installation</a></li>
<li><a href="admin.html">Administration</a>
	<ul class="level2"><li><a href="ServerStat_Help.html">Service Manager</a></li></ul></li>
<li><a href="security.html">Security</a></li>
<li><a href="config.html">Configurations</a>
	<ul class="level2">
	<li><a href="ServGeneral_Help.html">Server General</a></li>
	<li><a href="ServTuning_Help.html">Server Tuning</a></li>
	<li><a href="ServSecurity_Help.html">Server Security</a></li>
	<li><a href="RequestFilter_Help.html">Request Filter</a></li>
	<li><a href="Cache_Help.html">Page Cache</a></li>
	<li><a href="ExtApp_Help.html">External Apps</a></li>
	<li><a href="ScriptHandler_Help.html">Script Handler</a></li>
	<li><a href="Rails_Help.html">Rack/Rails Settings</a></li>
	<li><a href="Listeners_Help.html">Listeners</a></li>
	<li><a href="Templates_Help.html">Templates</a></li>
	<li><a href="VirtualHosts_Help.html">Virtual Host List</a></li>
	<li><a href="VHGeneral_Help.html">Virtual Host General</a></li>
	<li><span class="current"><a href="VHSecurity_Help.html">Virtual Host Security</a></span></li>
	<li><a href="Rewrite_Help.html">Rewrite</a></li>
	<li><a href="Context_Help.html">Context</a></li>
	<li><a href="VHAddOns_Help.html">Add-ons</a></li>
	<li><a href="AdminGeneral_Help.html">Admin Server</a></li>
	<li><a href="AdminListener_Help.html">Admin Listeners</a></li>
	</ul>

</li>
</ul>
</div></div>
<div class="contentwrapper"><div class="nav-bar"><div class="prev">&#171 <a href="VHGeneral_Help.html">Virtual Host General</a></div><div class="center"><a href="config.html">Configuration</a></div><div class="next"><a href="Rewrite_Help.html">Rewrite</a> &#187;</div></div>
<h1>Virtual Host Security</h1><h4>Table of Contents</h4><section class="toc"><section class="toc-row"><header>File Access Control</header><p>
<a href="#allowSymbolLink">Follow Symbolic Link</a>&nbsp;|&nbsp;<a href="#enableScript">Enable Script</a>&nbsp;|&nbsp;<a href="#restrained">Restrained</a>&nbsp;|&nbsp;</p></section>
<section class="toc-row"><header>Per Client Throttling Control</header><p>
<a href="#staticReqPerSec">Static Requests/Second</a>&nbsp;|&nbsp;<a href="#dynReqPerSec">Dynamic Requests/Second</a>&nbsp;|&nbsp;<a href="#outBandwidth">Outbound Bandwidth</a>&nbsp;|&nbsp;<a href="#inBandwidth">Inbound Bandwidth</a>&nbsp;|&nbsp;</p></section>
<section class="toc-row"><header>External Application Resource Control</header><p>
<a href="#setUidMode">ExtApp Set UID Mode</a>&nbsp;|&nbsp;<a href="#chrootMode">ExtApp Chroot Mode</a>&nbsp;|&nbsp;<a href="#chrootPath">ExtApp Chroot Path</a>&nbsp;|&nbsp;</p></section>
<section class="toc-row"><header><a href="#vhHotlink">Hotlink Control</a></header><p>
<a href="#enableHotlinkCtrl">Enable Hotlink Protection</a>&nbsp;|&nbsp;<a href="#suffixes">Suffix</a>&nbsp;|&nbsp;<a href="#redirectUri">Redirect URL</a>&nbsp;|&nbsp;<a href="#allowDirectAccess">Allow Direct Access</a>&nbsp;|&nbsp;<a href="#onlySelf">Only Self Reference</a>&nbsp;|&nbsp;<a href="#allowedHosts">Allowed Domains</a>&nbsp;|&nbsp;<a href="#matchedHosts">REGEX Matched Domains</a>&nbsp;|&nbsp;</p></section>
<section class="toc-row"><header><a href="#vhAccessControl">Access Control</a></header><p>
<a href="#vhaccessControl_allow">Allowed List</a>&nbsp;|&nbsp;<a href="#accessControl_deny">Denied List</a>&nbsp;|&nbsp;</p></section>
<section class="toc-row"><header><a href="#realms">Authorization Realms</a></header><p>
<a href="#realmName">Realm Name</a>&nbsp;|&nbsp;<a href="#realmType">DB Type</a>&nbsp;|&nbsp;<a href="#userDBLocation">User DB Location</a>&nbsp;|&nbsp;<a href="#userDB_attrPasswd">Password Attribute</a>&nbsp;|&nbsp;<a href="#userDB_attrMemberOf">Member-of Attribute</a>&nbsp;|&nbsp;<a href="#userDBMaxCacheSize">User DB Max Cache Size</a>&nbsp;|&nbsp;<a href="#userDBCacheTimeout">User DB Cache Timeout</a>&nbsp;|&nbsp;<a href="#GroupDBLocation">Group DB Location</a>&nbsp;|&nbsp;<a href="#groupDB_attrGroupMember">Group Member Attribute</a>&nbsp;|&nbsp;<a href="#groupDBMaxCacheSize">Group DB Max Cache Size</a>&nbsp;|&nbsp;<a href="#groupDBCacheTimeout">Group DB Cache Timeout</a>&nbsp;|&nbsp;<a href="#LDAPBindDN">LDAP Bind DN</a>&nbsp;|&nbsp;<a href="#LDAPBindPasswd">LDAP Bind Password</a>&nbsp;|&nbsp;</p></section>
<section class="toc-row"><header>Request Filter</header><p>
<a href="#enableCensorship">Enable Request Filtering</a>&nbsp;|&nbsp;<a href="#censorLogLevel">Log Level</a>&nbsp;|&nbsp;<a href="#defaultAction">Default Action</a>&nbsp;|&nbsp;<a href="#scanPOST">Scan Request Body</a>&nbsp;|&nbsp;<a href="#disableSecHtaccess">Disable .htaccess Override</a>&nbsp;|&nbsp;<a href="#secAuditLogEngine">Enable Security Audit Log</a>&nbsp;|&nbsp;<a href="#secAuditLog">Security Audit Log</a>&nbsp;|&nbsp;</p></section>
<section class="toc-row"><header><a href="#reqCensorshipRule">Request Filtering Rule Set</a></header><p>
<a href="#censorRuleSetName">Name</a>&nbsp;|&nbsp;<a href="#ruleSetAction">Rule Set Action</a>&nbsp;|&nbsp;<a href="#censorRuleSetEnabled">Enabled</a>&nbsp;|&nbsp;<a href="#censorRuleSet">Rules Definition</a>&nbsp;|&nbsp;</p></section>
</section>
<section><div class="helpitem"><a name="allowSymbolLink"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Follow Symbolic Link<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies whether to follow symbolic links in this virtual host.  <span class="val">IF OWNER MATCH</span> option will follow a symbolic link only if it has the same ownership.  This setting overrides the default server-level setting.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Select from drop down list</td></tr> <tr><td><span class="ht-label">Tips: </span>[Performance & security] For better security, disable this feature. For better performance, enable it.</td></tr> </table> </div>
<div class="helpitem"><a name="enableScript"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Enable Script<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies whether scripting (non-static pages) is allowed in this virtual host.  If disabled, CGI, FastCGI, LSAPI, Servlet engines and other scripting languages will not be allowed in this virtual host.  Therefore, if you want to use a script handler, you need to enable it here as well.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Select from radio box</td></tr> </table> </div>
<div class="helpitem"><a name="restrained"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Restrained<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies whether files beyond this virtual host root($VH_ROOT) can be accessed  though this web site. If set to <span class="val">Yes</span>, only files under $VH_ROOT can be accessed   and access to symbolic links or context pointing to files or directories beyond $VH_ROOT  will be denied. This, however, does not limit the accessibility of CGI scripts. This is useful  in the shared hosting environment. <span class="tagI"><a href="#allowSymbolLink">Follow Symbolic Link</a></span> can be set to <span class="val">Yes</span> to allow  users to use symbolic links under $VH_ROOT, but not anything beyond $VH_ROOT.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Select from radio box</td></tr> <tr><td><span class="ht-label">Tips: </span>[Security] Turn it on in the shared hosting environment.</td></tr> </table> </div>
<div class="helpitem"><a name="staticReqPerSec"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Static Requests/Second<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the maximum number of requests to static content coming from a single IP address that can be processed in a single second regardless of the number of connections established. <br/><br/> When this limit is reached, all future requests are tar-pitted until the next second.  Request limits for dynamically generated content are independent of this limit. Per-client request limits can be set at server- or virtual host-level.  Virtual host-level settings override server-level settings.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Integer number</td></tr> <tr><td><span class="ht-label">Tips: </span>[Security] Trusted IPs or sub-networks are not affected.</td></tr> <tr><td><span class="ht-label">See Also: </span><span class="tagI"><a href="#dynReqPerSec">Dynamic Requests/Second</a></span></td></tr> </table> </div>
<div class="helpitem"><a name="dynReqPerSec"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Dynamic Requests/Second<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the maximum number of requests to dynamically generated content  coming from a single IP address that can be processed in each second regardless of the number of connections established.  When this limit is reached, all future requests to dynamic content  are tar-pitted until the next second. <br/><br/> The request limit for static content is independent of this limit. This per client request limit can be set at server or virtual host level.  Virtual host-level settings override server-level settings.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Integer number</td></tr> <tr><td><span class="ht-label">Tips: </span>[Security] Trusted IPs or sub-networks are not restrained by this limit.</td></tr> <tr><td><span class="ht-label">See Also: </span><span class="tagI"><a href="#staticReqPerSec">Static Requests/Second</a></span></td></tr> </table> </div>
<div class="helpitem"><a name="outBandwidth"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Outbound Bandwidth<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the maximum allowed outgoing throughput to a single IP address regardless of number of connections established. The real bandwidth may end up being slightly higher than this setting for efficiency reasons.  Bandwidth is allocated in 4KB units. Set to <span class="val">0</span> to disable throttling. Per-client bandwidth limits (bytes/sec) can be set at server- or virtual-host levels. Virtual host-level settings override server-level settings.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Integer number</td></tr> <tr><td><span class="ht-label">Tips: </span>[Performance] Set the bandwidth in 8KB units for better performance.<br/> [Security] Trusted IPs or sub-networks are not affected.</td></tr> <tr><td><span class="ht-label">See Also: </span><span class="tagI"><a href="#inBandwidth">Inbound Bandwidth</a></span></td></tr> </table> </div>
<div class="helpitem"><a name="inBandwidth"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Inbound Bandwidth<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the maximum allowed incoming throughput from a single IP address regardless of number of connections established. The real bandwidth may end up being slightly higher than this setting for efficiency reasons.  Bandwidth is allocated in 1KB units. Set to <span class="val">0</span> to disable throttling. Per-client bandwidth limits (bytes/sec) can be set at server- or virtual-host levels. Virtual host-level settings override server-level settings.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Integer number</td></tr> <tr><td><span class="ht-label">Tips: </span>[Security] Trusted IPs or sub-networks are not affected.</td></tr> <tr><td><span class="ht-label">See Also: </span><span class="tagI"><a href="#outBandwidth">Outbound Bandwidth</a></span></td></tr> </table> </div>
<div class="helpitem"><a name="setUidMode"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>ExtApp Set UID Mode<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies how user ID is set for an external application process. Three choices are available:  <ul><li><span class="val">Server UID</span>: Set the user/group ID of external application processes  to the same as the server's user/group ID.</li>     <li><span class="val">CGI File UID</span>: Set the user/group ID of external CGI processes based  	on the user/group ID of the executable. This option only applies to CGI, not FastCGI or LSPHP.</li>     <li><span class="val">Doc Root UID</span>: Set the user/group ID of external application processes based  	on the user/group ID of the document root of the current virtual host.</li> </ul></td></tr> <tr><td><span class="ht-label">Syntax: </span>Select from drop down list</td></tr> <tr><td><span class="ht-label">Tips: </span>[Security] In the shared hosting environment, it is recommended to use the <span class="val">CGI File UID</span> or <span class="val">Doc Root UID</span> modes to prevent files owned by one virtual host from being accessed by the external application scripts of another virtual host.</td></tr> </table> </div>
<div class="helpitem"><a name="chrootMode"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>ExtApp Chroot Mode<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span><span class="tag">Enterprise Edition Only</span> Specifies how the root directory is set for an external application process. In order to protect confidential system data files from being accessed by a vulnerable external application script, an alternative root path can be set for the external application process so that files beyond the new root directory become inaccessible. This is referred to as a "chroot jail".<br/><br/> Three choices are available:  <ul><li><span class="val">Same as Server</span>: External application processes will be run in the same jail as the server.</li>     <li><span class="val">Virtual Host Root</span>: Set chroot jail to the root directory of the virtual host. The external application script will only be able to access files inside the virtual host root. </li> 	<li><span class="val">Customized Chroot Path</span>: Specify the chroot path <span class="tagI"><a href="#chrootPath">ExtApp Chroot Path</a></span> below. </li> </ul></td></tr> <tr><td><span class="ht-label">Syntax: </span>Select from drop down list</td></tr> <tr><td><span class="ht-label">Tips: </span>If used properly, chroot will greatly enhance the security of external application scripts, but you must make sure the external application script is functional in the limited chroot jail environment.</td></tr> </table> </div>
<div class="helpitem"><a name="chrootPath"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>ExtApp Chroot Path<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span><span class="tag">Enterprise Edition Only</span> Specifies a new root directory for the current host's external application scripts   when <span class="tagI"><a href="#chrootMode">ExtApp Chroot Mode</a></span> is set to <span class="val">Customized Chroot Path</span>.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Absolute path.</td></tr> </table> </div>
<div class="helpitem"><a name="vhHotlink"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Hotlink Control<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Hotlinks are requests made from an external website to files on your own website often referred to as "leeching". This practice introduces additional bandwidth usage that you should not be responsible for.<br/><br/> LiteSpeed web server can prevent others from hotlinking to content on your web site by checking the Referer header within a HTTP request.  If the Referer header does not match your website, the request will be denied.</td></tr> </table> </div>
<div class="helpitem"><a name="enableHotlinkCtrl"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Enable Hotlink Protection<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies whether to activate hotlink protection.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Select from radio box</td></tr> </table> </div>
<div class="helpitem"><a name="suffixes"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Suffix<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies what kinds of files will be protected from hotlinking by listing file suffixes.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Comma delimited list. "." is prohibited</td></tr> </table> </div>
<div class="helpitem"><a name="redirectUri"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Redirect URL<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies a URL that a user will be redirected to when a hotlinking action is detected. You can redirect users to an image or page saying hotlinking is not allowed. If it is not specified,  <span class="val">403 Forbidden</span> will be returned.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Absolute URL</td></tr> </table> </div>
<div class="helpitem"><a name="allowDirectAccess"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Allow Direct Access<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies whether to allow direct access without a referer.  A referer header identifies the webpage that linked to the current page.  There is no "referer" header in HTTP requests when a user types in an address directly in the address box or uses a feature like "save target link as".</td></tr> <tr><td><span class="ht-label">Syntax: </span>Select from radio box</td></tr> </table> </div>
<div class="helpitem"><a name="onlySelf"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Only Self Reference<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies whether to only allow references from the current web site itself. When set to <span class="val">Yes</span>, <span class="tagI"><a href="#allowedHosts">Allowed Domains</a></span> has no effect and no other web site can link to protected files. This can be convenient if you wish to  park multiple domain names on the current web site.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Select from radio box</td></tr> </table> </div>
<div class="helpitem"><a name="allowedHosts"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Allowed Domains<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies which web sites can link to protected content.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Comma delimited list of domain names.</td></tr> </table> </div>
<div class="helpitem"><a name="matchedHosts"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>REGEX Matched Domains<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies web sites that can link to protected content in regular expressions. The regular expression will match the domain name only and not the full URL.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Regular expressions</td></tr> <tr><td><span class="ht-label">Example: </span>^.*\.mydomain\.com$</td></tr> </table> </div>
<div class="helpitem"><a name="vhAccessControl"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Access Control<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies what sub-networks and/or IP addresses can access this virtual host  in addition to server-level access control. This virtual host setting does NOT override  the server setting. Whether to block/allow an IP is determined by the combination  of the allowed list and denied list. If you want to block only certain IPs or sub-networks,  put <span class="val">*</span> or <span class="val">ALL</span> in the allowed list and list the blocked IPs or  sub-networks in the denied list. If you want to only allow certain IPs or sub-networks,  put <span class="val">*</span> or <span class="val">ALL</span> in the denied list and list the allowed IPs or  sub-networks in the allowed list. The setting of the smallest scope that fits for  an IP will be used to determine whether to block or allow access.</td></tr> </table> </div>
<div class="helpitem"><a name="vhaccessControl_allow"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Allowed List<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the list of IPs or sub-networks allowed.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Comma-delimited list of IP addresses or sub-networks. <span class="val">*</span> or <span class="val">ALL</span> are allowed.   Sub-networks can be written as <span class="val">192.168.1.0/255.255.255.0</span>, <span class="val">192.168.1</span> or <span class="val">192.168.1.*</span>.</td></tr> </table> </div>
<div class="helpitem"><a name="accessControl_deny"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Denied List<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the list of IPs or sub-networks disallowed.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Comma delimited list of IP addresses or sub-networks.  <span class="val">*</span> or <span class="val">ALL</span> are accepted.</td></tr> <tr><td><span class="ht-label">Example: </span>Sub-networks:  <span class="val">192.168.1.0/255.255.255.0</span>, <span class="val">192.168.1.0/24</span>, <span class="val">192.168.1</span> or <span class="val">192.168.1.*</span>. <br/> IPv6 addresses: <span class="val">::1</span> or <span class="val">[::1]</span> <br/> IPv6 subnets: <span class="val">3ffe:302:11:2:20f:1fff:fe29:717c/64</span> or  <span class="val">[3ffe:302:11:2:20f:1fff:fe29:717c]/64</span>.</td></tr> </table> </div>
<div class="helpitem"><a name="realms"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Authorization Realms<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Lists all authorization realms for this virtual host.  Authorization realms are used to block unauthorized users from accessing protected web pages. A realm is a user directory containing user names and passwords with optional  group classifications. Authorization is performed at context level.  Since different contexts can share the same realm (user database), so realms are  defined separately from the contexts that use them.  You can refer to a realm by these names in context configuration.</td></tr> </table> </div>
<div class="helpitem"><a name="realmName"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Realm Name<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies a unique name for the authorization realm.</td></tr> </table> </div>
<div class="helpitem"><a name="realmType"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>DB Type<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies how user/group data is stored for an authorization realm. Currently, user/group data can be stored in flat files or on a LDAP server.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Select from drop down list</td></tr> </table> </div>
<div class="helpitem"><a name="userDBLocation"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>User DB Location<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the location of the user database.  For DB type <span class="val">Password File</span>, it is the path to the flat file containing user/password definitions. You can edit this file through the WebAdmin console by clicking on the file name.<br/><br/> Each line of the user file contains a username followed by a colon,  followed by a crypt() encrypted password, optionally followed by a colon  and group names that user belongs to. Group names are delimitated by commas.  If group information is specified in the user database, then the group database will not be checked.<br/><br/> Example:<blockquote><code>john:HZ.U8kgjnMOHo:admin,user</code></blockquote><br/><br/> For DB type <span class="val">LDAP</span>, it is the LDAP URL to query for the user information. For each valid user, the authentication data stored in the LDAP server should contain at least the user id and user password. One and only one record should be returned in the LDAP search request based on the this URL and username received in the HTTP Authentication header. "$k" must be specified in the filter part of the URL and it will be replaced with the username. The user password attribute must be returned in the query result. The attribute name of the user password is specified by <span class="tagI"><a href="#userDB_attrPasswd">Password Attribute</a></span>. Group information can be optionally specified by <span class="tagI"><a href="#userDB_attrMemberOf">Member-of Attribute</a></span>.<br/><br/> Example: At minimum, a user can be defined in LDAP with object classes: uidObject, simpleSecurityObject and organizationalRole. The following URL could be used: <br/><br/> <blockquote><code>ldap://localhost/ou=UserDB,dc=example,dc=com???(&(objectClass=*)(uid=$k))</code></blockquote></td></tr> <tr><td><span class="ht-label">Syntax: </span>Path to the user DB file or LDAP URL (RFC 2255).</td></tr> <tr><td><span class="ht-label">Tips: </span>[Security] It is recommended to store user password files outside of the document tree.  If a user password file has to be placed inside document tree, simply name it with a leading ".ht"  like <span class="val">.htuser</span> to prevent it being served as a static file.  LiteSpeed Web Server  does not serve files prefixed with ".ht".</td></tr> <tr><td><span class="ht-label">See Also: </span><span class="tagI"><a href="#GroupDBLocation">Group DB Location</a></span>, <span class="tagI"><a href="#userDB_attrPasswd">Password Attribute</a></span>, <span class="tagI"><a href="#userDB_attrMemberOf">Member-of Attribute</a></span></td></tr> </table> </div>
<div class="helpitem"><a name="userDB_attrPasswd"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Password Attribute<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the name of the password attribute for a user record stored in an LDAP server. The default value is <span class="val">userPassword</span>.</td></tr> <tr><td><span class="ht-label">Syntax: </span>string</td></tr> </table> </div>
<div class="helpitem"><a name="userDB_attrMemberOf"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Member-of Attribute<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the name of the "Member-of" attribute for a user record  stored in an LDAP server. The default value is <span class="val">memberOf</span>. The "Member-of"  attribute can be used to specify the group name that the user belongs to.</td></tr> <tr><td><span class="ht-label">Syntax: </span>string</td></tr> </table> </div>
<div class="helpitem"><a name="userDBMaxCacheSize"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>User DB Max Cache Size<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the maximum cache size of the user database.  Recently accessed user authentication data will be cached in memory  to provide maximum performance.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Integer number</td></tr> <tr><td><span class="ht-label">Tips: </span>[Performance] As a larger cache will consume more memory,  a higher value may or may not provide better performance. Set it to an appropriate size according  to your user database size and site usage.</td></tr> </table> </div>
<div class="helpitem"><a name="userDBCacheTimeout"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>User DB Cache Timeout<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies how often the backend user database will be checked for changes.   Every entry in the cache has a timestamp.  When cached data is older than the specified timeout, the backend database will be checked  for changes. If there is no change, the timestamp will be reset to the current time, otherwise  the new data will be loaded. Sevrer reload and graceful restart will clear the cache immediately.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Integer number</td></tr> <tr><td><span class="ht-label">Tips: </span>[Performance] If the backend database does not change very often,  set a longer timeout for better performance.</td></tr> </table> </div>
<div class="helpitem"><a name="GroupDBLocation"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Group DB Location<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the location of the group database. <br/> Group information can be set either in the user database or in this standalone group DB. For user authentication, the user DB will be checked first. If the user DB also contains group information, then the group DB will not be checked. <br/><br/> For the DB type <span class="val">Password File</span>, the group DB location should be the path to  the flat file containing group definitions. You can edit this file through the  WebAdmin console by clicking on the file name. <br/><br/> Each line of a group file should contain a groupname followed by a colon,   followed by space delimited group of user names. Example:<br/> <blockquote><code>testgroup: user1 user2 user3</code></blockquote> <br/><br/> For the DB type <span class="val">LDAP</span>, the group DB location should be the LDAP URL to query  for group information. For each valid group, one and only one record should be returned in the LDAP search request based on  this URL and the group name specified in <span class="tagI"><a href="Context_Help.html#required">Require (Authorized Users/Groups)</a></span>. "$k" must be specified in the filter part of the URL and it will be replaced with the group name. The name of the attribute that  specifies members in this group is specified by <span class="tagI"><a href="#groupDB_attrGroupMember">Group Member Attribute</a></span>.<br/><br/> Example: If objectClass posixGroup is being used to store group information. The following URL could be used: <br/> <blockquote><code>ldap://localhost/ou=GroupDB,dc=example,dc=com???(&(objectClass=*)(cn=$k))</code></blockquote></td></tr> <tr><td><span class="ht-label">Syntax: </span>File name which can be absolute, or relative to $SERVER_ROOT, or relative to $VH_ROOT.</td></tr> <tr><td><span class="ht-label">Tips: </span>[Security] It is recommended to store a group file outside the document tree.  If it has to be placed inside document tree, simply name it with a leading ".ht"  like <span class="val">.htgroup</span>, to prevent the file being served as a static file.  LiteSpeed Web Server  does not serve files prefixed with ".ht".</td></tr> <tr><td><span class="ht-label">See Also: </span><span class="tagI"><a href="#userDBLocation">User DB Location</a></span>, Context <span class="tagI"><a href="Context_Help.html#required">Require (Authorized Users/Groups)</a></span>, <span class="tagI"><a href="#groupDB_attrGroupMember">Group Member Attribute</a></span></td></tr> </table> </div>
<div class="helpitem"><a name="groupDB_attrGroupMember"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Group Member Attribute<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the name of the "Member" attribute for a group record stored in an LDAP server. The default value is <span class="val">memberUid</span>.</td></tr> <tr><td><span class="ht-label">Syntax: </span>string</td></tr> </table> </div>
<div class="helpitem"><a name="groupDBMaxCacheSize"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Group DB Max Cache Size<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the maximum cache size of the group database.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Integer number</td></tr> <tr><td><span class="ht-label">Tips: </span>[Performance] As a larger cache will consume more memory,  a higher value may or may not provide better performance. Set it to an appropriate size according  to your user database size and site usage.</td></tr> <tr><td><span class="ht-label">See Also: </span><span class="tagI"><a href="#userDBMaxCacheSize">User DB Max Cache Size</a></span></td></tr> </table> </div>
<div class="helpitem"><a name="groupDBCacheTimeout"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Group DB Cache Timeout<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies how often the backend group database will be checked for changes.  For more detail please refer to <span class="tagI"><a href="#userDBCacheTimeout">User DB Cache Timeout</a></span>.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Integer number</td></tr> <tr><td><span class="ht-label">See Also: </span><span class="tagI"><a href="#userDBCacheTimeout">User DB Cache Timeout</a></span></td></tr> </table> </div>
<div class="helpitem"><a name="LDAPBindDN"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>LDAP Bind DN<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies a DN used to bind to the server. If the LDAP server  requires authentication, a bind DN and password must be specified. If not specified, anonymous bind will be used.</td></tr> <tr><td><span class="ht-label">Syntax: </span>string</td></tr> <tr><td><span class="ht-label">See Also: </span><span class="tagI"><a href="#LDAPBindPasswd">LDAP Bind Password</a></span></td></tr> </table> </div>
<div class="helpitem"><a name="LDAPBindPasswd"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>LDAP Bind Password<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies a password used to bind to the server. If the LDAP Server  requires authentication, a bind DN and password must be specified.</td></tr> <tr><td><span class="ht-label">Syntax: </span>string</td></tr> <tr><td><span class="ht-label">See Also: </span><span class="tagI"><a href="#LDAPBindDN">LDAP Bind DN</a></span></td></tr> </table> </div>
<div class="helpitem"><a name="enableCensorship"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Enable Request Filtering<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies whether to enable request content deep inspection. This feature is equivalent to Apache's mod_security, which can be used to detect and block requests with ill intention by matching them to known signatures.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Select from radio box</td></tr> </table> </div>
<div class="helpitem"><a name="censorLogLevel"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Log Level<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the level of detail of the request filtering engine's debug output. This value ranges from <span class="val">0</span> - <span class="val">9</span>. <span class="val">0</span> disables logging. <span class="val">9</span> produces the most detailed log. The the server and virtual host's error log <span class="tagI"><a href="ServGeneral_Help.html#log_logLevel">Log Level</a></span> must be set to at least <span class="val">INFO</span> for this option to take effect. This is useful when testing your request filtering rules.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Integer number</td></tr> <tr><td><span class="ht-label">See Also: </span>Server <span class="tagI"><a href="ServGeneral_Help.html#log_logLevel">Log Level</a></span>, Virtual Host <span class="tagI"><a href="VHGeneral_Help.html#vhlog_logLevel">Log Level</a></span></td></tr> </table> </div>
<div class="helpitem"><a name="defaultAction"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Default Action<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the default actions that should be taken when a censoring rule is met. Default value is <span class="val">deny,log,status:403</span>, which means to deny access with status code 403 and log the incident in the error log.</td></tr> <tr><td><span class="ht-label">Syntax: </span> String. This action string is compatible with the syntax of Apache mod_security. Please refer to the mod_security manual for more detail. <br/> EXAMPLE:  END_EXAMPLE<br/> TIPS:  END_TIPS<br/> </td></tr> <tr><td><span class="ht-label">See Also: </span><span class="tagI"><a href="#ruleSetAction">Rule Set Action</a></span></td></tr> </table> </div>
<div class="helpitem"><a name="scanPOST"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Scan Request Body<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies whether to check the body of a HTTP POST request.  Default is "No".</td></tr> <tr><td><span class="ht-label">Syntax: </span>Select from radio box</td></tr> </table> </div>
<div class="helpitem"><a name="disableSecHtaccess"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Disable .htaccess Override<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies whether to disable .htaccess override. This is a global setting, only available at the server level.  Default is "No".</td></tr> <tr><td><span class="ht-label">Syntax: </span>Select from radio box</td></tr> </table> </div>
<div class="helpitem"><a name="secAuditLogEngine"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Enable Security Audit Log<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies whether to enable audit logging. This feature is equivalent to Apache's mod_security audit engine.  If it is enabled and <span class="tagI"><a href="#secAuditLog">Security Audit Log</a></span> is set, detailed request information will be saved.</td></tr> <tr><td><span class="ht-label">Syntax: </span>Select from radio box</td></tr> <tr><td><span class="ht-label">See Also: </span><span class="tagI"><a href="#secAuditLog">Security Audit Log</a></span></td></tr> </table> </div>
<div class="helpitem"><a name="secAuditLog"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Security Audit Log<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the path of the security audit log, which gives more detailed information.   This extra information can be useful if, for example, you wish to track the actions of   a particular user. Use <span class="tagI"><a href="#secAuditLogEngine">Enable Security Audit Log</a></span> to turn on the logging.</td></tr> <tr><td><span class="ht-label">Syntax: </span>File name which can be an absolute path or relative to $SERVER_ROOT.</td></tr> <tr><td><span class="ht-label">See Also: </span><span class="tagI"><a href="#secAuditLogEngine">Enable Security Audit Log</a></span></td></tr> </table> </div>
<div class="helpitem"><a name="reqCensorshipRule"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Request Filtering Rule Set<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Rules configured here only work for virtual hosts configured with a native LSWS configuration, not for virtual hosts using Apache httpd.conf.</td></tr> </table> </div>
<div class="helpitem"><a name="censorRuleSetName"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Name<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Give a group of censorship rules a name. For display only.</td></tr> <tr><td><span class="ht-label">Syntax: </span>String</td></tr> </table> </div>
<div class="helpitem"><a name="ruleSetAction"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Rule Set Action<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies the actions that should be taken when a censoring rule in current ruleset is met. If not set, <span class="tagI"><a href="#defaultAction">Default Action</a></span> will be used.</td></tr> <tr><td><span class="ht-label">Syntax: </span>String.  This action string uses the same syntax as directive SecDefaultAction in  Apache mod_security, please refer to the mod_security manual for more details.</td></tr> </table> </div>
<div class="helpitem"><a name="censorRuleSetEnabled"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Enabled<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies whether to enable this rule set. With this option, a rule set can be quickly turned on and off without adding or removing the rule set. Default is "Yes".</td></tr> <tr><td><span class="ht-label">Syntax: </span>Select from radio box</td></tr> </table> </div>
<div class="helpitem"><a name="censorRuleSet"></a><table width="100%" class="ht" border="0" cellpadding="5" cellspacing="0"> <tr class="ht-title"><td><div>Rules Definition<span class="top"><a href="#top"><img border=0 height=13 width=13 alt="Go to top" src="img/top.gif"></a></span></div></td></tr> <tr><td><span class="ht-label">Description: </span>Specifies a list of censorship rules.<br/><br/> If you are using an Apache config file, you have to set up rules in httpd.conf.  Rules defined here will have no effect.</td></tr> <tr><td><span class="ht-label">Syntax: </span>String. Syntax of censoring rules follows that of Apache's mod_security directives. "SecFilter", "SecFilterSelective", and "SecRule" can be  used here.  You can copy and paste security rules from an Apache configuration file.<br/><br/> For more details about rule syntax, please refer to the  <a href="http://www.modsecurity.org/documentation/index.html" target="_blank">Mod Security documentation</a>.</td></tr> <tr><td><span class="ht-label">Tips: </span>Rules configured here only work for vhosts configured in native LSWS configuration, not for vhosts from Apache httpd.conf.</td></tr> </table> </div>
</section>
</div><footer class="copyright">Copyright &copy; 2003-2014. <a href="http://www.litespeedtech.com">Lite Speed Technologies Inc.</a> All rights reserved.</footer>
				</div>
				</body>
				</html>